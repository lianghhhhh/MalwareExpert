from sisa import SISA

if __name__ == '__main__':
    mySISA = SISA()

    # for training(inclde testing)
    mySISA.divide_data()
    #mySISA.preprocess()
    """mySISA.split_train_test()
    mySISA.shard_data()
    mySISA.slice_shard_data()"""
    mySISA.model(training=True)

    """# for prediction
    mySISA.preprocess()
    mySISA.majority_vote()

    # for unlearning
    mySISA.machine_unlearning()"""


    """for i in range(subDetector().config.model.shard_count):
        # create a subDetector and train it
        myDetector = subDetector()

        # open record file, get the data names in this shard(i), put to myDetector.data
        myDetector.train_data, myDetector.test_data = mySISA.get_data(i)

        myDetector.extractFeature()
        myDetector.vectorize()
        myDetector.model(training=True)


    # for prediction
    myDetector = subDetector()
    myDetector.predict_data = mySISA.get_data(train=False)
    myDetector.extractFeature()
    myDetector.vectorize()
    myDetector.model(training=False)
    myDetector.predict()
    myDetector.explain()

    # for unlearning
    for i in range(subDetector().config.model.shard_count):
        myDetector = subDetector()
        myDetector.unlearn_data = mySISA.get_data(unlearn=True)
        myDetector.machine_unlearning()"""
