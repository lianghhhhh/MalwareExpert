# Capstone Disassembler Documentation

## Overview

The `capstone_disassembler.py` file provides functions for disassembling binary code into normalized assembly instructions using the Capstone disassembly framework.

## Functions

### filter_memory_references

```python
def filter_memory_references(i):
```

Normalizes a disassembled instruction by filtering and standardizing memory references.

#### Parameters:
- `i` (capstone.CsInsn): A Capstone disassembled instruction object.

#### Returns:
- str: A normalized string representation of the instruction.

#### Process:
1. Processes each operand of the instruction.
2. Normalizes register names, immediate values, and memory references.
3. Replaces spaces with underscores in the final representation.

### disassemble

```python
def disassemble(asm, arch, bits, verbose=False):
```

Disassembles a binary string into normalized assembly instructions.

#### Parameters:
- `asm` (str): A hexadecimal string representing the binary code.
- `arch` (str): The architecture of the binary ('x86', 'arm', 'mips', or 'ppc').
- `bits` (int): The bit mode of the binary (32 or 64).
- `verbose` (bool): If True, print error messages for unsupported architectures.

#### Returns:
- list: A list of normalized assembly instruction strings.

#### Process:
1. Converts the hexadecimal string to binary.
2. Sets up the Capstone disassembler based on the specified architecture and bit mode.
3. Disassembles the binary and normalizes each instruction.
4. Prefixes each normalized instruction with "X_".

## Usage

```python
hex_code = "554889e54883ec20897dec488975e0"
instructions = disassemble(hex_code, "x86", 64)
for inst in instructions:
    print(inst)
```

This module is essential for converting raw binary data into a normalized assembly representation that can be processed by the SAFE model. It handles multiple architectures and provides consistent output formatting.
