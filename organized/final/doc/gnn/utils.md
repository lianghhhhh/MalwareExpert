# ASM2VEC Utilities Module Documentation

## Overview

The `utils.py` module provides a `MalwareAnalyzer` class with various utility functions for malware analysis using graph neural networks. This class includes methods for data loading, model training, and model explanation.

## Class: MalwareAnalyzer

```python
class MalwareAnalyzer:
```

This class implements utility functions for malware analysis.

### Initialization

```python
def __init__(self, logger=None, config: dict = None):
```

#### Parameters:
- `logger` (optional): Logger object. If None, a new logger will be created.
- `config` (dict, optional): Configuration dictionary.

### Key Methods

#### load_asm2vec_data

```python
def load_asm2vec_data(self, embedding_files: list, predict: bool=False):
```

Loads ASM2Vec data from embedding files.

#### load_SAFE_data

```python
def load_SAFE_data(self, embedding_files: list, predict: bool=False):
```

Loads SAFE data from embedding files.

#### train

```python
def train(self, model, all_data, criterion, optimizer):
```

Trains the model for one epoch.

#### GNNexplain

```python
def GNNexplain(self, model, shard_index: int, slice_index: int, test_data: list):
```

Explains the model using GNNExplainer.

#### edge_pruning

```python
def edge_pruning(self, model, shard_index: int, slice_index: int, test_data: list):
```

Performs edge pruning on the graph.

#### node_pruning

```python
def node_pruning(self, model, shard_index: int, slice_index: int, test_data: list):
```

Performs node pruning on the graph.

## Usage

To use the MalwareAnalyzer in your project:

```python
from utils import MalwareAnalyzer

# Initialize the analyzer
config = {...}  # Your configuration dictionary
analyzer = MalwareAnalyzer(config=config)

# Load data
feature_matrix, edge_index, labels, names = analyzer.load_asm2vec_data(embedding_files)

# Train model
total_loss = analyzer.train(model, all_data, criterion, optimizer)

# Explain model
analyzer.GNNexplain(model, shard_index, slice_index, test_data)

# Perform pruning
analyzer.edge_pruning(model, shard_index, slice_index, test_data)
analyzer.node_pruning(model, shard_index, slice_index, test_data)
```

This utility class provides a comprehensive set of tools for working with graph-based malware analysis models, from data loading to model explanation and graph pruning techniques.
