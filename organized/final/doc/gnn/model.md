# ASM2VEC Model Module Documentation

## Overview

The `model.py` module defines the `MalwareExpertModel`, a Graph Neural Network (GNN) model designed for malware detection. This model incorporates multiple graph convolutional layers, including custom `deeperGCN` layers, to process and analyze graph-structured data representing malware samples.

## Class: MalwareExpertModel

```python
class MalwareExpertModel(nn.Module):
```

This class implements the MalwareExpert Graph Neural Network model for malware detection.

### Architecture:
1. Linear layer
2. Graph Convolution
3. 7 deeperGCN layers
4. Normalization
5. Activation
6. Global Mean Pooling
7. Dropout
8. Linear layer
9. Softmax

### Initialization

```python
def __init__(self, input_dim: int, hidden_dim: int, config: dict=None):
```

#### Parameters:
- `input_dim` (int): Dimension of input features.
- `hidden_dim` (int): Dimension of hidden layers.
- `config` (dict, optional): Configuration dictionary containing model parameters.

### Forward Pass

```python
def forward(self, x: torch.Tensor, edge_index: Adj, data: torch.Tensor) -> torch.Tensor:
```

#### Parameters:
- `x` (torch.Tensor): Node feature matrix with shape [num_nodes, input_dim].
- `edge_index` (Adj): Graph connectivity in COO format with shape [2, num_edges].
- `data` (torch.Tensor): Data tensor with shape [num_nodes, num_features].

#### Returns:
- torch.Tensor: Output tensor with shape [batch_size, output_dim].

#### Process:
1. Apply initial linear transformation
2. Apply graph convolution
3. Apply 7 deeperGCN layers
4. Apply layer normalization and ReLU activation
5. Perform global mean pooling
6. Apply dropout
7. Apply final linear transformation
8. Apply softmax activation

## Usage

To use the MalwareExpertModel in your project:

```python
from model import MalwareExpertModel

# Define configuration
config = {
    "model": {
        "dropout_value": 0.5,
        "output_dim": 2,
        "softmax_dim": 1
    }
}

# Initialize the model
model = MalwareExpertModel(input_dim=100, hidden_dim=64, config=config)

# Forward pass
output = model(x, edge_index, data)
```

This model is designed to process graph-structured data representing malware samples and output a probability distribution over malware classes. It's particularly suited for binary classification tasks (malware vs. benignware) but can be adapted for multi-class classification by adjusting the output dimension.
