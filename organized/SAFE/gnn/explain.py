# for user to explain the model
import torch
import torch_geometric
import torch_geometric.data
from utils import load_data, GNNexplain, edge_pruning, node_pruning
import csv


#load data
feature_matrix, edge_index, name = load_data(predict=True)

x = [torch.tensor(feature_matrix[i], dtype=torch.float) for i in range(len(feature_matrix))]
edge_index = [torch.tensor(edge_index[i], dtype=torch.long) for i in range(len(edge_index))]
name = name
all_data = [torch_geometric.data.Data(x=x[i], edge_index=edge_index[i], name=name[i]) for i in range(len(x))]

#explain the model
GNNexplain(all_data)
edge_pruning(all_data)
node_pruning(all_data)
