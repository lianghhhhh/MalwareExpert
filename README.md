# MalwareExpert
**implement paper:**\
**- malware detector: <https://ieeexplore.ieee.org/document/10145856>**\
**- SISA training: <https://arxiv.org/abs/1912.03817>**\
**The project isn't finished yet; I'm still editing.**
## SAFE
**reference: <https://github.com/facebookresearch/SAFEtorch>**
- download SAFE model:
```git
cd organized/SAFE
wget http://dl.fbaipublicfiles.com/SAFEtorch/model.tar.gz
tar -xzvf model.tar.gz
rm model.tar.gz
```

## asm2vec
**reference: <https://github.com/oalieno/asm2vec-pytorch>**
- download asm2vec model:
```git
cd organized/asm2vec
```

## Input
**config.json**
| name | usage |
| :-- | :-- |
| word2id | the path of word2id.json |
| SAFEtorch | the path of SAFEtorch.pt |
| asm2vec_model | the path of asm2vec model |
| label | the path of the label of the data set |
| record | the path to store the record of the training data |
| score | the path to store the score of the models |
| result | the path to store the result of predictions |
| dataset | the path of the dataset folder |
| embedding | the folder to store the embeddings |
| feature | the folder to store the features |
| vectorize | the folder to store the vectorize files |
| model | the folder to store models |
| predict | the folder of data for prediction |
| unlearn | the folder of data for unlearning |
| epoch | how much epoch to train in a slice |
| learning_rate | the learning rate when training |
| batch_size | the batch size when training |
| hidden_dim | the hidden dimension |
| shard_count | divide into how many shards |
| slice_count | divide into how many slices |
| train | do the training process |
| predict | do the prediction |
| unlearn | unlearn some data after training |

## Output
**log.txt**
- print out the progress while the program is running

**record.json**
- record the data's name, the purpose of the data (train or test), where the data is in the models, and has the date be unlearned
  
**result.json**
- the name of the predicted data and its result, 0 for benign ware, 1 for malware
  
**score.json**
- the accuracy, precision, recall, and f1 score after SISA training, also records the training and validation loss in every epoch of each model
