# MalwareExpert
implement paper: <https://ieeexplore.ieee.org/document/10145856>\
The project isn't finished yet; I'm still editing.
## SAFE
1. first download the model

> @inproceedings{massarelli2018safe,
>   title={SAFE: Self-Attentive Function Embeddings for Binary Similarity},
>   author={Massarelli, Luca and Di Luna, Giuseppe Antonio and Petroni, Fabio and Querzoni, Leonardo and Baldoni, Roberto},
>   booktitle={Proceedings of 16th Conference on Detection of Intrusions and Malware & Vulnerability Assessment (DIMVA)},
>   year={2019}
> }

```git
cd SAFE_torch
wget http://dl.fbaipublicfiles.com/SAFEtorch/model.tar.gz
tar -xzvf model.tar.gz
rm model.tar.gz
```
2. get the function call graph with SAFE embedding in dot file
```git
python test.py
```
3. change directory to gnn
```git
cd gnn
```
4. train MalwareExpert and validation
```git
python main.py
```
## asm2vector
1. change directory to asm2vec
```git
cd asm2vec-pytorch
```
2. transfer binary files to assembly files
```git
python scripts/bin2asm.py
```
3. train a model
```git
python scripts/train.py
```
4. get the function call graph with asm2vec embedding in dot file
```git
python scripts/test.py
```
5. change directory to gnn
```git
cd gnn
```
6. train MalwareExpert and validation
```git
python main.py
```
## run organized file (asm2vec)
1. change directory to asm2vec
```git
cd organized/asm2vec
```
2. modify config.json to meet the path you want\
   **change "dataset" to the path where your dataset is in & change "feature" to ...**
3. run subDtector.py
```git
python subDetector.py
```
